<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Çerçeve Profil Hesaplayıcı</title>
  <style>
    body { background: #2c2c2c; color: #f1f1f1; font-family: Arial, sans-serif; padding: 20px; }
    .row { display: flex; gap: 10px; margin-bottom: 10px; }
    input { width: 80px; padding: 5px; background: #444; border: 1px solid #777; color: #fff; }
    button { padding: 10px 20px; background: #4caf50; border: none; border-radius:4px; color:#fff; cursor:pointer; }
    button:hover { background: #45a049; }
    pre { background: #1e1e1e; padding:15px; border-radius:5px; white-space:pre-wrap; }
    #addRow { background: #2196f3; margin-left: 10px; }
    #addRow:hover { background: #1976d2; }
  </style>
</head>
<body>
  <h2>Çerçeve Profil Hesaplayıcı</h2>
  <div id="inputs">
    <!-- İlk 4 alan sabit olarak eklendi -->
    <div class="row">
      <input type="number" placeholder="En 1">
      <input type="number" placeholder="Boy 1">
      <input type="number" placeholder="Adet 1">
    </div>
    <div class="row">
      <input type="number" placeholder="En 2">
      <input type="number" placeholder="Boy 2">
      <input type="number" placeholder="Adet 2">
    </div>
    <div class="row">
      <input type="number" placeholder="En 3">
      <input type="number" placeholder="Boy 3">
      <input type="number" placeholder="Adet 3">
    </div>
    <div class="row">
      <input type="number" placeholder="En 4">
      <input type="number" placeholder="Boy 4">
      <input type="number" placeholder="Adet 4">
    </div>
  </div>

  <button id="calc">Hesapla</button>
  <button id="addRow">+</button>
  <pre id="out"></pre>

  <script>
    const inputsDiv = document.getElementById('inputs');
    let rowCount = 4;

    document.getElementById('addRow').addEventListener('click', () => {
      rowCount++;
      const row = document.createElement('div');
      row.className = 'row';
      row.innerHTML = `
        <input type="number" placeholder="En ${rowCount}">
        <input type="number" placeholder="Boy ${rowCount}">
        <input type="number" placeholder="Adet ${rowCount}">
      `;
      inputsDiv.appendChild(row);
    });

    document.getElementById('calc').addEventListener('click', () => {
      const PAY=0.4, CAP=600, ED=4, BD=8;
      const cuts = [];
      const rows = document.querySelectorAll('#inputs .row');

      rows.forEach(row => {
        const [wEl, hEl, cEl] = row.querySelectorAll('input');
        const w = +wEl.value, h = +hEl.value, n = +cEl.value;
        if(w && h && n > 0){
          const wVis=w-ED, hVis=h-BD,
                wReal=+(wVis+PAY).toFixed(1),
                hReal=+(hVis+PAY).toFixed(1);
          for(let j=0;j<n;j++){
            cuts.push({vis:wVis,real:wReal});
            cuts.push({vis:wVis,real:wReal});
            cuts.push({vis:hVis,real:hReal});
            cuts.push({vis:hVis,real:hReal});
          }
        }
      });

      if(!cuts.length){
        out.innerText='Lütfen değer girin!';
        return;
      }

      const freq = {};
      cuts.forEach(c => freq[c.vis] = (freq[c.vis] || 0) + 1);
      cuts.sort((a,b) => b.real - a.real);

      const bins = [];
      cuts.forEach(c => {
        let best = -1, minRem = Infinity;
        bins.forEach((b,i) => {
          if(b.rem >= c.real && b.rem - c.real < minRem){
            minRem = b.rem - c.real; best = i;
          }
        });
        if(best >= 0){
          bins[best].segs.push(c.vis);
          bins[best].rem = +(bins[best].rem - c.real).toFixed(1);
        } else {
          bins.push({segs:[c.vis], rem:+(CAP - c.real).toFixed(1)});
        }
      });

      let text = '=== Kesim Miktarları ===\n';
      Object.keys(freq).sort((a,b)=>b-a).forEach(k => {
        text += `• ${k} cm: ${freq[k]} adet\n`;
      });

      text += `\nToplam profil: ${bins.length} adet\n\n`;
      bins.forEach((b,i) => {
        text += `${i+1}. profil: ${b.segs.join(', ')} cm  |  artan: ${b.rem} cm\n`;
      });

      document.getElementById('out').innerText = text;
    });
  </script>
</body>
</html>
